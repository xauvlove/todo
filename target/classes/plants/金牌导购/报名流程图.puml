@startuml
skinparam sequenceArrowThickness 1
skinparam roundcorner 20
skinparam maxmessagesize 500
/'skinparam sequenceParticipant underline'/

actor 导购 as u

participant "h5" as h5
participant "retail-sales" as sales
participant "kdtId white list" as list
participant "salesman white list" as list2

participant "salesman_rank_log" as t1
participant "salesman_achievement_details_log" as t2

participant "apollo" as apollo

u -> h5 : 1报名
activate h5

h5 -> sales : 2请求报名
activate sales

sales -> apollo : 2.1查询报名开始时间
activate apollo
return 2.2 返回

sales -> list : 3校验白名单
note left
    检查导购所属 rootKdtId 是否存在于被邀请列表

    这个白名单是邀请商家之后就写好的
end note
activate list

return 4返回

sales -> t1 : 5写入db
note left
    导购报名成功之后写入db里面，
    这样以后只更新这张表即可，不用再往里面insert数据了

    db写入 salesman_rank_log，
    paid_amount = 0
    finish_amount = 0
    sign_up_time = now()
    version = 1
end note
activate t1
return 6返回

sales -> list2 : 7写入白名单
note left
    白名单记录导购是否已经报名
    为方便以后的校验
end note
activate list2
return 8返回

return 9报名成功

return 10报名成功

@enduml